"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6568],{4998:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var i=t(4848),o=t(8453);const r={slug:"/fp/4",description:"\u4f7f\u7528Monad\uff08\u6d0b\u8471\uff09\u89e3\u51b3\u5d4c\u5957functor"},a=void 0,s={id:"\u8ba1\u7b97\u673a\u57fa\u7840/fp/Monad",title:"Monad",description:"\u4f7f\u7528Monad\uff08\u6d0b\u8471\uff09\u89e3\u51b3\u5d4c\u5957functor",source:"@site/docs/\u8ba1\u7b97\u673a\u57fa\u7840/fp/4-Monad.md",sourceDirName:"\u8ba1\u7b97\u673a\u57fa\u7840/fp",slug:"/fp/4",permalink:"/note/fp/4",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{slug:"/fp/4",description:"\u4f7f\u7528Monad\uff08\u6d0b\u8471\uff09\u89e3\u51b3\u5d4c\u5957functor"},sidebar:"fp",previous:{title:"\u5bb9\u5668",permalink:"/note/fp/3"},next:{title:"Applicative Functor",permalink:"/note/fp/5"}},l={},c=[{value:"pointed functor",id:"pointed-functor",level:3},{value:"join",id:"join",level:3},{value:"chain",id:"chain",level:3},{value:"\u7ec3\u4e60",id:"\u7ec3\u4e60",level:3}];function u(n){const e={blockquote:"blockquote",code:"code",em:"em",h3:"h3",p:"p",pre:"pre",...(0,o.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h3,{id:"pointed-functor",children:"pointed functor"}),"\n",(0,i.jsxs)(e.p,{children:["container.of \u7684\u4f5c\u7528\u4e0d\u4ec5\u4ec5\u662f\u4ee3\u66ff new \u5173\u952e\u5b57\u8fdb\u884c\u5bb9\u5668\u521b\u5efa\uff0c\u800c\u662f\u7528\u6765\u5c06\u503c\u653e\u5728",(0,i.jsx)(e.em,{children:"\u9ed8\u8ba4\u6700\u5c0f\u5316\u4e0a\u4e0b\u6587"}),"\u4e2d"]}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsxs)(e.p,{children:["pointer funtor \u5c31\u662f\u5b9e\u73b0\u4e86 ",(0,i.jsx)("div",{style:{backgroundColor:"lightgrey",display:"inline-block",padding:"0 6px"},children:"of"})," \u65b9\u6cd5\u7684 functor"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4ece\u800c\u80fd\u591f\u8fdb\u4e00\u6b65\u8fdb\u884c map \u8c03\u7528"}),"\n",(0,i.jsx)(e.h3,{id:"join",children:"join"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u5f88\u591a\u60c5\u51b5\u6211\u4eec\u5bf9\u4e00\u4e2a container \u8fdb\u884c map \u65f6\u4f1a\u5c06\u5176\u5305\u8fdb\u53e6\u4e00\u4e2a container \u4e2d\uff0c\u4ece\u800c\u5bfc\u81f4\u8fc7\u591a\u7684 container \u5305\u88f9\u4f7f\u5176\u540e\u7eed\u96be\u4ee5\u5904\u7406\u4e86\uff0c\u5229\u7528 join \u65b9\u6cd5\u53ef\u4ee5\u5c06\u76f8\u540c\u7c7b\u578b\u7684\u5bb9\u5668\u8fdb\u884c\u5408\u5e76\u4ece\u800c\u9632\u6b62\u8fc7\u591a\u7684\u76f8\u540c\u5bb9\u5668\u5d4c\u5957\uff0c\u4ee5 Maybe \u5bb9\u5668\u4e3a\u4f8b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"Maybe.prototype.join = function () {\n  return this.isNothing() ? Maybe.of(null) : this.__value\n}\n//  join :: Monad m => m (m a) -> m a\nvar join = function (mma) {\n  return mma.join()\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"chain",children:"chain"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u62e5\u6709 join \u540e\uff0c\u6211\u4eec\u6bcf\u8c03\u7528\u4e00\u6b21 map \u82e5\u8fd4\u56de\u7684\u662f\u5b58\u5728\u5d4c\u5957\u7684\u5bb9\u5668\uff0c\u90fd\u9700\u8981\u8ddf\u4e00\u4e2a join \u8fdb\u884c\u89e3\u5957\uff0c\u800c chain \u65b9\u6cd5\u76f4\u63a5\u7ed3\u5408 map \u548c join\uff0c\u5c06\u8fd9\u4e24\u4e2a\u884c\u62bd\u8c61\u6210\u4e3a\u4e00\u4e2a chain \u884c\u4e3a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"//  chain :: Monad m => (a -> m b) -> m a -> m b\nvar chain = curry(function (f, m) {\n  return m.map(f).join() // \u6216\u8005 compose(join, map(f))(m)\n})\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u7ec3\u4e60",children:"\u7ec3\u4e60"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"require('../../support')\nvar Task = require('data.task')\nvar _ = require('ramda')\n\n// Exercise 1\n// ==========\n// Use safeProp and map/join or chain to safely get the street name when given a user\n\nvar safeProp = _.curry(function (x, o) {\n  return Maybe.of(o[x])\n})\nvar user = {\n  id: 2,\n  name: 'albert',\n  address: {\n    street: {\n      number: 22,\n      name: 'Walnut St'\n    }\n  }\n}\n\nvar ex1 = _.compose(\n  _.chain(safeProp('name')),\n  _.chain(safeProp('street')),\n  safeProp('address')\n)\n// Exercise 2\n// ==========\n// Use getFile to get the filename, remove the directory so it's just the file, then purely log it.\n\nvar getFile = function () {\n  return new IO(function () {\n    return require('path').basename(__filename)\n  })\n}\n\nvar pureLog = function (x) {\n  return new IO(function () {\n    console.log(x)\n    return 'logged ' + x // for testing w/o mocks\n  })\n}\n\nvar ex2 = _.compose(_.chain(pureLog), getFile)\n// Exercise 3\n// ==========\n// Use getPost() then pass the post's id to getComments().\n\nvar getPost = function (i) {\n  return new Task(function (rej, res) {\n    setTimeout(function () {\n      res({ id: i, title: 'Love them tasks' }) // THE POST\n    }, 300)\n  })\n}\nvar getComments = function (i) {\n  return new Task(function (rej, res) {\n    setTimeout(function () {\n      res([\n        { post_id: i, body: 'This book should be illegal' },\n        { post_id: i, body: 'Monads are like smelly shallots' }\n      ])\n    }, 300)\n  })\n}\n\nvar ex3 = _.compose(\n  _.chain(getComments),\n  map((post) => post.id),\n  getPost\n)\n\n// Exercise 4\n// ==========\n// Use validateEmail, addToMailingList and emailBlast to implement ex4's type signature.\n// It should safely add a new subscriber to the list, then email everyone with this happy news.\n\n//  addToMailingList :: Email -> IO [Email]\nvar addToMailingList = (function (list) {\n  return function (email) {\n    return new IO(function () {\n      list.push(email)\n      return list\n    })\n  }\n})([])\n\n//  emailBlast :: [Email] -> IO String\nfunction emailBlast(list) {\n  return new IO(function () {\n    return 'emailed: ' + list.join(',') // for testing w/o mocks\n  })\n}\n\n//  validateEmail :: Email -> Either String Email\nvar validateEmail = function (x) {\n  return x.match(/\\S+@\\S+\\.\\S+/)\n    ? new Right(x)\n    : new Left('invalid email')\n}\n\n//  ex4 :: Email -> Either String (IO String)\nvar ex4 = _.compose(\n  _.map(_.chain(emailBlast)),\n  _.map(addToMailingList),\n  validateEmail\n)\n\nmodule.exports = {\n  ex1: ex1,\n  ex2: ex2,\n  ex3: ex3,\n  ex4: ex4,\n  user: user\n}\n"})})]})}function d(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(u,{...n})}):u(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>a,x:()=>s});var i=t(6540);const o={},r=i.createContext(o);function a(n){const e=i.useContext(r);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:a(n.components),i.createElement(r.Provider,{value:e},n.children)}}}]);