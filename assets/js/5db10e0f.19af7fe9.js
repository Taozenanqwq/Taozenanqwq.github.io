"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4528],{7657:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>c});var t=r(4848),s=r(8453);const a={slug:"/fp/1",description:"\u4ecb\u7ecd\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u57fa\u672c\u6982\u5ff5"},i=void 0,o={id:"\u8ba1\u7b97\u673a\u57fa\u7840/fp/\u7b80\u4ecb",title:"\u7b80\u4ecb",description:"\u4ecb\u7ecd\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u57fa\u672c\u6982\u5ff5",source:"@site/docs/\u8ba1\u7b97\u673a\u57fa\u7840/fp/1-\u7b80\u4ecb.md",sourceDirName:"\u8ba1\u7b97\u673a\u57fa\u7840/fp",slug:"/fp/1",permalink:"/note/fp/1",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{slug:"/fp/1",description:"\u4ecb\u7ecd\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u57fa\u672c\u6982\u5ff5"},sidebar:"fp",previous:{title:"\u51fd\u6570\u5f0f\u7f16\u7a0b",permalink:"/note/fp"},next:{title:"\u58f0\u660e\u5f0f\u4ee3\u7801",permalink:"/note/fp/2"}},l={},c=[{value:"\u51fd\u6570\u662f\u4e00\u7b49\u516c\u6c11",id:"\u51fd\u6570\u662f\u4e00\u7b49\u516c\u6c11",level:3},{value:"\u7eaf\u51fd\u6570\u7684\u597d\u5904",id:"\u7eaf\u51fd\u6570\u7684\u597d\u5904",level:3},{value:"\u4e0d\u53ef\u6216\u7f3a\u7684 Curry",id:"\u4e0d\u53ef\u6216\u7f3a\u7684-curry",level:3},{value:"\u7ec4\u5408 Compose",id:"\u7ec4\u5408-compose",level:3},{value:"\u7ec3\u4e60",id:"\u7ec3\u4e60",level:3}];function p(n){const e={blockquote:"blockquote",code:"code",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h3,{id:"\u51fd\u6570\u662f\u4e00\u7b49\u516c\u6c11",children:"\u51fd\u6570\u662f\u4e00\u7b49\u516c\u6c11"}),"\n",(0,t.jsx)(e.p,{children:"\u51fd\u6570\u5728 js \u4e2d\u662f\u4e00\u7b49\u516c\u6c11\uff0c\u5373\u51fd\u6570\u548c\u6240\u6709\u5176\u4ed6\u7c7b\u578b\u4e00\u6837\u6ca1\u6709\u4ec0\u4e48\u4e0d\u540c\uff0c\u53ef\u4ee5\u50cf\u5bf9\u5f85\u4efb\u4f55\u5176\u4ed6\u6570\u636e\u4e00\u6837\u5bf9\u5f85\u51fd\u6570"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-typescript",children:"//\u4e0d\u597d\u7684\u5199\u6cd5\nhttpGet('/post/2', (json, err) => renderPost(json, err))\n\n//\u597d\u7684\u5199\u6cd5, \u53ca\u65f6\u589e\u52a0\u53c2\u6570\u4e5f\u4e0d\u9700\u8981\u4fee\u6539\nhttpGet('/post/2', renderPost)\n\n//\u4e0d\u597d\u7684\u5199\u6cd5,\u4e22\u5931\u4e86this\nfs.readFile('test.txt', Db.save)\n\n//\u597d\u4e00\u70b9\u7684\u5199\u6cd5\nfs.readFile('test.txt', Db.save.bind(Db))\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u7eaf\u51fd\u6570\u7684\u597d\u5904",children:"\u7eaf\u51fd\u6570\u7684\u597d\u5904"}),"\n",(0,t.jsx)(e.p,{children:"\u4ec0\u4e48\u662f\u7eaf\u51fd\u6570\uff1f"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\u7eaf\u51fd\u6570\u662f\u8fd9\u6837\u4e00\u79cd\u51fd\u6570\uff0c\u5373\u76f8\u540c\u7684\u8f93\u5165\uff0c\u6c38\u8fdc\u8fd8\u4f1a\u5f97\u5230\u76f8\u540c\u7684\u8f93\u51fa\uff0c\u800c\u4e14\u6ca1\u6709\u4efb\u4f55\u53ef\u89c2\u5bdf\u7684\u526f\u4f5c\u7528"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"\u4ec0\u4e48\u662f\u526f\u4f5c\u7528\uff1f"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\u526f\u4f5c\u7528\u662f\u5728\u8ba1\u7b97\u8fc7\u7a0b\u4e2d\uff0c\u7cfb\u7edf\u72b6\u6001\u7684\u4e00\u79cd\u53d8\u5316\uff0c\u6216\u8005\u4e0e\u5916\u90e8\u4e16\u754c\u8fdb\u884c\u7684\u53ef\u89c2\u5bdf\u7684\u4ea4\u4e92"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"\u8ffd\u6c42\u7eaf\u51fd\u6570\u7684\u7406\u7531"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u53ef\u7f13\u5b58\u6027(Cacheable)"}),"\uff1a\u7531\u4e8e\u7eaf\u51fd\u6570\u7684\u5b9a\u4e49\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u8ba1\u7b97\u8fc7\u7684\u7ed3\u679c\u8fdb\u884c\u7f13\u5b58"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u53ef\u79fb\u690d\u6027(Portable)"}),"\uff1a\u7531\u4e8e\u5176\u4e0d\u4f9d\u8d56\u7cfb\u7edf\u73af\u5883\uff0c\u56e0\u6b64\u79fb\u690d\u7b80\u5355\uff0c\u53ea\u8981\u6309\u7167\u5b9a\u4e49\u7684\u65b9\u5f0f\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u8fd0\u884c\uff0c\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u51fd\u6570\u6807\u7b7e\u5f97\u5230\u66f4\u591a\u7684\u4fe1\u606f"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u53ef\u6d4b\u8bd5\u6027(Testable)"}),"\uff1a\u4e0d\u4f9d\u8d56\u7cfb\u7edf\u73af\u5883\uff0c\u56e0\u6b64\u6d4b\u8bd5\u65f6\u53ea\u9700\u8981\u5bf9\u8bbe\u5b9a\u8f93\u5165\u5e76\u5bf9\u8f93\u51fa\u8fdb\u884c\u65ad\u8a00"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u5408\u7406\u6027(Reasonable)"}),"\uff1a\u7eaf\u51fd\u6570\u662f\u5f15\u7528\u900f\u660e\u7684\uff0c\u4e00\u6bb5\u7eaf\u51fd\u6570\u53ef\u4ee5\u66ff\u6362\u4e3a\u4ed6\u6267\u884c\u6240\u5f97\u7684\u7ed3\u679c\uff0c\u66f4\u65b9\u4fbf\u4ee3\u7801\u5206\u6790"]}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"\u4e0d\u53ef\u6216\u7f3a\u7684-curry",children:"\u4e0d\u53ef\u6216\u7f3a\u7684 Curry"}),"\n",(0,t.jsx)(e.p,{children:"curry \u7684\u6982\u5ff5\uff1a\u53ea\u4f20\u9012\u7ed9\u51fd\u6570\u4e00\u90e8\u5206\u53c2\u6570\u6765\u8c03\u7528\u5b83\uff0c\u8ba9\u5b83\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\u53bb\u5904\u7406\u5269\u4e0b\u7684\u53c2\u6570\u3002\n\u53ef\u4ee5\u4e00\u6b21\u6027\u5730\u8c03\u7528 curry \u51fd\u6570\uff0c\u4e5f\u53ef\u4ee5\u6bcf\u6b21\u53ea\u4f20\u4e00\u4e2a\u53c2\u6570\u5206\u591a\u6b21\u8c03\u7528\u3002"}),"\n",(0,t.jsx)(e.p,{children:"curry \u901a\u8fc7\u5c40\u90e8\u8c03\u7528\u7684\u65b9\u5f0f\u5f97\u5230\u4e00\u4e9b\u201c\u9884\u52a0\u8f7d\u201d\u7684\u51fd\u6570\uff0c\u51cf\u5c11\u4e86\u6837\u677f\u6587\u4ef6\u4ee3\u7801"}),"\n",(0,t.jsx)(e.h3,{id:"\u7ec4\u5408-compose",children:"\u7ec4\u5408 Compose"}),"\n",(0,t.jsx)(e.p,{children:"compose \u901a\u8fc7\u5c06\u4e00\u7cfb\u5217\u51fd\u6570\u7ec4\u5408\u5230\u4e00\u8d77\uff0c\u8ba9\u6570\u636e\u80fd\u591f\u5728\u8be5\u7ba1\u9053\u4e2d\u8fdb\u884c\u6d41\u52a8\uff0c\u5b83\u521b\u5efa\u4e86\u4e00\u4e2a\u4ece\u53f3\u5230\u5de6\u7684\u6570\u636e\u6d41\uff0c\u8fd9\u6837\u505a\u7684\u53ef\u8bfb\u6027\u8fdc\u8fdc\u9ad8\u4e8e\u5d4c\u5957\u4e00\u5927\u5806\u7684\u51fd\u6570\u8c03\u7528\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4ece\u53f3\u5230\u5de6\u7684\u65b9\u6cd5\u8c03\u7528\u4e86\u89e3\u6570\u636e\u4ece\u8f93\u5165\u5230\u8f93\u51fa\u7ecf\u8fc7\u4e86\u54ea\u4e9b\u65b9\u6cd5\u3002"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"pointfree"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-typescript",children:"// \u975e pointfree\uff0c\u56e0\u4e3a\u63d0\u5230\u4e86\u6570\u636e\uff1aword\nvar snakeCase = function (word) {\n  return word.toLowerCase().replace(/\\s+/gi, '_')\n}\n\n// pointfree\nvar snakeCase = compose(replace(/\\s+/gi, '_'), toLowerCase)\n"})}),"\n",(0,t.jsx)(e.p,{children:"pointfree \u53ef\u4ee5\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u547d\u540d\uff0c\u5728\u7b2c\u4e00\u4e2a\u65b9\u6cd5\u4e2d\u9700\u8981 word \u53c2\u6570\u91c7\u7528\u8fdb\u884c\u540e\u7eed\u64cd\u4f5c"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"debug"})}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u4f7f\u7528\u7ec4\u5408\u51fd\u6570\u9047\u5230\u95ee\u9898\u65f6\u53ef\u4ee5\u4f7f\u7528 debug \u51fd\u6570\u8ffd\u8e2a\u4ee3\u7801\u6267\u884c\u60c5\u51b5"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-typescript",children:"var trace = curry(function (tag, x) {\n  console.log(tag, x)\n  return x\n})\n\nvar dasherize = compose(\n  join('-'),\n  // error-next-line\n  toLower,\n  trace('after split'),\n  split(' '),\n  replace(/\\s{2,}/gi, ' ')\n)\n\ndasherize('The world is a vampire')\n// after split [ 'The', 'world', 'is', 'a', 'vampire' ]\n// TypeError: Cannot read property 'apply' of undefined\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u7ec3\u4e60",children:"\u7ec3\u4e60"}),"\n",(0,t.jsx)(e.p,{children:"Curry"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-typescript",children:"var _ = require('ramda')\n\n// \u7ec3\u4e60 1\n//==============\n// \u901a\u8fc7\u5c40\u90e8\u8c03\u7528\uff08partial apply\uff09\u79fb\u9664\u6240\u6709\u53c2\u6570\n\nvar words = function (str) {\n  return split(' ', str)\n}\n//highlight-start\n//solution\nwords = split(' ')\n//highlight-end\n// \u7ec3\u4e60 1a\n//==============\n// \u4f7f\u7528 `map` \u521b\u5efa\u4e00\u4e2a\u65b0\u7684 `words` \u51fd\u6570\uff0c\u4f7f\u4e4b\u80fd\u591f\u64cd\u4f5c\u5b57\u7b26\u4e32\u6570\u7ec4\n\nvar sentences = undefined\n//highlight-start\n//solution\nsentences = map(words)\n//highlight-end\n\n// \u7ec3\u4e60 2\n//==============\n// \u901a\u8fc7\u5c40\u90e8\u8c03\u7528\uff08partial apply\uff09\u79fb\u9664\u6240\u6709\u53c2\u6570\n\nvar filterQs = function (xs) {\n  return filter(function (x) {\n    return match(/q/i, x)\n  }, xs)\n}\n// highlight-start\n//solution\nfilterQs = filter((x) => match(/q/i, x))\n// highlight-end\n\n// \u7ec3\u4e60 3\n//==============\n// \u4f7f\u7528\u5e2e\u52a9\u51fd\u6570 `_keepHighest` \u91cd\u6784 `max` \u4f7f\u4e4b\u6210\u4e3a curry \u51fd\u6570\n\n// \u65e0\u987b\u6539\u52a8:\nvar _keepHighest = function (x, y) {\n  return x >= y ? x : y\n}\n\n// \u91cd\u6784\u8fd9\u6bb5\u4ee3\u7801:\nvar max = function (xs) {\n  return reduce(\n    function (acc, x) {\n      return _keepHighest(acc, x)\n    },\n    -Infinity,\n    xs\n  )\n}\n// highlight-start\n//solution\nmax = reduce((acc, x) => _keepHighest(acc, x), 0)\n// highlight-end\n// \u5f69\u86cb 1:\n// ============\n// \u5305\u88f9\u6570\u7ec4\u7684 `slice` \u51fd\u6570\u4f7f\u4e4b\u6210\u4e3a curry \u51fd\u6570\n// //[1,2,3].slice(0, 2)\nvar slice = undefined\n// highlight-start\n//solution\nslice = curry(function (start, end, arr) {\n  return arr.slice(start, end)\n})\n// highlight-end\n\n// \u5f69\u86cb 2:\n// ============\n// \u501f\u52a9 `slice` \u5b9a\u4e49\u4e00\u4e2a `take` curry \u51fd\u6570\uff0c\u8be5\u51fd\u6570\u8c03\u7528\u540e\u53ef\u4ee5\u53d6\u51fa\u5b57\u7b26\u4e32\u7684\u524d n \u4e2a\u5b57\u7b26\u3002\nvar take = undefined\n// highlight-start\n//solution\ntake = slice(0)\n// highlight-end\n"})}),"\n",(0,t.jsx)(e.p,{children:"Compose"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-typescript",children:"require('../../support')\nvar _ = require('ramda')\nvar accounting = require('accounting')\n\n// \u793a\u4f8b\u6570\u636e\nvar CARS = [\n  {\n    name: 'Ferrari FF',\n    horsepower: 660,\n    dollar_value: 700000,\n    in_stock: true\n  },\n  {\n    name: 'Spyker C12 Zagato',\n    horsepower: 650,\n    dollar_value: 648000,\n    in_stock: false\n  },\n  {\n    name: 'Jaguar XKR-S',\n    horsepower: 550,\n    dollar_value: 132000,\n    in_stock: false\n  },\n  {\n    name: 'Audi R8',\n    horsepower: 525,\n    dollar_value: 114200,\n    in_stock: false\n  },\n  {\n    name: 'Aston Martin One-77',\n    horsepower: 750,\n    dollar_value: 1850000,\n    in_stock: true\n  },\n  {\n    name: 'Pagani Huayra',\n    horsepower: 700,\n    dollar_value: 1300000,\n    in_stock: false\n  }\n]\n\n// \u7ec3\u4e60 1:\n// ============\n// \u4f7f\u7528 _.compose() \u91cd\u5199\u4e0b\u9762\u8fd9\u4e2a\u51fd\u6570\u3002\u63d0\u793a\uff1a_.prop() \u662f curry \u51fd\u6570\nvar isLastInStock = function (cars) {\n  var last_car = _.last(cars)\n  return _.prop('in_stock', last_car)\n}\n// highlight-start\n//solution\nisLastInStock = compose(prop('in_stock'), last)\n// highlight-end\n\n// \u7ec3\u4e60 2:\n// ============\n// \u4f7f\u7528 _.compose()\u3001_.prop() \u548c _.head() \u83b7\u53d6\u7b2c\u4e00\u4e2a car \u7684 name\nvar nameOfFirstCar = undefined\n// highlight-start\n//solution\nnameOfFirstCar = compose(prop('name'), head)\n//highlight-end\n\n// \u7ec3\u4e60 3:\n// ============\n// \u4f7f\u7528\u5e2e\u52a9\u51fd\u6570 _average \u91cd\u6784 averageDollarValue \u4f7f\u4e4b\u6210\u4e3a\u4e00\u4e2a\u7ec4\u5408\nvar _average = function (xs) {\n  return reduce(add, 0, xs) / xs.length\n} // <- \u65e0\u987b\u6539\u52a8\n\nvar averageDollarValue = function (cars) {\n  var dollar_values = map(function (c) {\n    return c.dollar_value\n  }, cars)\n  return _average(dollar_values)\n}\n// highlight-start\n//solution\naverageDollarValue = compose(_average, prop('dollar_value'))\n// highlight-end\n\n// \u7ec3\u4e60 4:\n// ============\n// \u4f7f\u7528 compose \u5199\u4e00\u4e2a sanitizeNames() \u51fd\u6570\uff0c\u8fd4\u56de\u4e00\u4e2a\u4e0b\u5212\u7ebf\u8fde\u63a5\u7684\u5c0f\u5199\u5b57\u7b26\u4e32\uff1a\u4f8b\u5982\uff1asanitizeNames([\"Hello World\"]) //=> [\"hello_world\"]\u3002\n\nvar _underscore = replace(/\\W+/g, '_') //<-- \u65e0\u987b\u6539\u52a8\uff0c\u5e76\u5728 sanitizeNames \u4e2d\u4f7f\u7528\u5b83\n\nvar sanitizeNames = undefined\n// highlight-start\n//solution\nsanitizeNames = map(compose(toLower, _underscore, prop('name')))\n// highlight-end\n\n// \u5f69\u86cb 1:\n// ============\n// \u4f7f\u7528 compose \u91cd\u6784 availablePrices\n\nvar availablePrices = function (cars) {\n  var available_cars = _.filter(_.prop('in_stock'), cars)\n  return available_cars\n    .map(function (x) {\n      return accounting.formatMoney(x.dollar_value)\n    })\n    .join(', ')\n}\n// highlight-start\n//solution\navailablePrices = compose(\n  join(', '),\n  map(compose(accounting.formatMoney, prop('dollar_value'))),\n  filter(prop('in_stock'))\n)\n// highlight-end\n\n// \u5f69\u86cb 2:\n// ============\n// \u91cd\u6784\u4f7f\u4e4b\u6210\u4e3a pointfree \u51fd\u6570\u3002\u63d0\u793a\uff1a\u53ef\u4ee5\u4f7f\u7528 _.flip()\n\nvar fastestCar = function (cars) {\n  var sorted = _.sortBy(function (car) {\n    return car.horsepower\n  }, cars)\n  var fastest = _.last(sorted)\n  return fastest.name + ' is the fastest'\n}\n// highlight-start\n//solution\nfastestCar = compose(\n  (name) => name + ' is the fastest',\n  prop('name'),\n  last,\n  sortBy((car) => car.horsepower)\n)\n// highlight-end\n"})})]})}function h(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(p,{...n})}):p(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>i,x:()=>o});var t=r(6540);const s={},a=t.createContext(s);function i(n){const e=t.useContext(a);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:i(n.components),t.createElement(a.Provider,{value:e},n.children)}}}]);